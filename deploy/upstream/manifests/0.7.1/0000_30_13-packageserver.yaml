##---
# Source: olm/templates/0000_30_13-packageserver.yaml
apiVersion: apiregistration.k8s.io/v1beta1
kind: APIService
metadata:
  name: v1alpha1.packages.apps.redhat.com
spec:
  caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5VENDQWQyZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFjTVJvd0dBWURWUVFERXhGd1lXTnIKWVdkbExYTmxjblpsY2kxallUQWVGdzB4T0RFd01Ea3dNVFV3TWpGYUZ3MHlPREV3TURZd01UVXdNakZhTUJ3eApHakFZQmdOVkJBTVRFWEJoWTJ0aFoyVXRjMlZ5ZG1WeUxXTmhNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DCkFROEFNSUlCQ2dLQ0FRRUF0ZWxuanR3M1FhZUdhNUtqRGs3eGtJa09oaExLTzJXZ21ZK2hZdTJONkpsWU1DZFoKaEtIaDMreERnczh0UFpnRmZ1WW0zcktaTmhkd2ZNMFFDWTR0eGNrRjhvd0VoYmh4alppaVhPR3BsRUhralI4ZQpOalpxQ2lWaURrK0JicC9GUkJhKzZlNjhoOXh6YTZubDlQeWp3alZ2YzZMeWtuZFRZamNybWtUQVR0T1NzTGFrCkNkeXl6MHAwRDBXWThjOUwrOFdWa29vcWtNS0gvdXFiZFFJNWhmRGFua2p4dXZxZEN4enkvYjFlNW9nWmlheU0KaWtzdkFBZHRkcDl2Y09jYk1aRlUyNXNHRXF4dFl5NjZ3M1RzYzcyaEI1QTV2RnlHTXkySjRJQU5oM0RMcXowbgp4aG9LYzBFdTBJbG1UVDdPMjJKb0NiQXVnblBMdUNVQS9HOUY2UUlEQVFBQm8wSXdRREFPQmdOVkhROEJBZjhFCkJBTUNBcVF3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01BOEdBMVVkRXdFQi93UUYKTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSEdRZG41MzRlekc1Q09JSjJ5cFRWT082UjdZbXFhZAphYVAyekNIK3VDeXAxbys0U2l2TnpURnljakJPM0VVUVN6VzN0TWJvL2M0Q0hJa3dzUWhGQ2ZIOGR5UFdqNHk5CmVLTWFlSk5mNDZxWGlmMWJzeWU5c2ZzSjJBL2YvL2dwLyswWHVzNzh2dERITkVDOWE2UUorNTRQU3lKdzA0ZkgKM1VOWVVkNkx2U05yREdGN284emZSUElLYllJdjFSczdRRnM0Z3pTdzFkRkxkYzlvMWNiNmZRVUVLSkkranYregpCV0xZR0lmNlF6cXJHaEFvam1aSHd0ZWIrSmVURmJzaTU1K3I3aDlTaUZJZ1YzRXBMWGl2UldyQUFjd3duWmg5Cnh0OTFiTFdBRFliclZVMXRoWm5XRXRNRDE4NEd3UE5ySnZ2eDFFQ2pubHlJOXhMYzcvb1RVcGs9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  group: packages.apps.redhat.com
  groupPriorityMinimum: 2000
  versionPriority: 15
  service:
    name: package-server
    namespace: olm
  version: v1alpha1
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: packagemanifest:system:auth-delegator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: olm-operator-serviceaccount
  namespace: olm
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: packagemanifest-auth-reader
  namespace: kube-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: extension-apiserver-authentication-reader
subjects:
- kind: ServiceAccount
  name: olm-operator-serviceaccount
  namespace: olm
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: packagemanifest-view
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: admin
subjects:
- kind: ServiceAccount
  name: olm-operator-serviceaccount
  namespace: olm
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: package-apiserver-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: aggregated-apiserver-clusterrole
subjects:
- kind: ServiceAccount
  name: olm-operator-serviceaccount
  namespace: olm
---
apiVersion: v1
kind: Secret
type: kubernetes.io/tls
metadata:
  name: package-server-certs
  namespace: olm
  labels:
    app: package-server
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURKakNDQWc2Z0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFjTVJvd0dBWURWUVFERXhGd1lXTnIKWVdkbExYTmxjblpsY2kxallUQWVGdzB4T0RFd01Ea3dNVFV3TWpKYUZ3MHhPVEV3TURrd01UVXdNakphTUJreApGekFWQmdOVkJBTVREbkJoWTJ0aFoyVXRjMlZ5ZG1WeU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBCk1JSUJDZ0tDQVFFQXZYSWQ2MFBGaGRLenBHK0s1TUNqZVJEdmtucVovbkNFUTZIdWRPZ1NsWHJhcWN3WmptdG8KY1JRelRNWjA4UVY0RVhrT044alpZRjhFOTEyVTB5STdvSndTalRTRitDOUl4dFRYSy9OOEI4VWVia3FybVY0VQovem5HcGYxSHBCN2RTSUR3STdOWlMyODdwamY2eDF2a01NSlRYWUZkNWNTaHIrUTZGZlBIaHFBVGo2b2wwbUJRCkhRSG5yUFhhTG1kTlQ3RkRYTXBlZHR4clUwSEpFamJxSmV6NlVTNEFtWkRiTXJMT1MzT3pQU0tmRS9oS3B4WkEKQmtqYmhEZWcwRXozNzdIOUlvelVTbVNHRFVKZHJIVHd6QnlXTUNva1hMWFJBZjAvdnVlMnBoK2dCdVNtT21JWApzNVpxb3l2bmx4V016Z1VsZ2Z6MFg5L2k5aGt2cEI5a0RRSURBUUFCbzNZd2REQU9CZ05WSFE4QkFmOEVCQU1DCkJhQXdIUVlEVlIwbEJCWXdGQVlJS3dZQkJRVUhBd0VHQ0NzR0FRVUZCd01DTUF3R0ExVWRFd0VCL3dRQ01BQXcKTlFZRFZSMFJCQzR3TElJU2NHRmphMkZuWlMxelpYSjJaWEl1YjJ4dGdoWndZV05yWVdkbExYTmxjblpsY2k1dgpiRzB1YzNaak1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQmtjcVVJQWxTa0NDN0ZTSlZIQm9JQU5JZ3dJcGZhCmVFOGFDS2JRVm5rQmxTd2FybXFPVDJXRFUvN2ozSGV1NHR5Q0RuT2g1d2E1SVFPQlczRm9PaThDbEhpUWlVVmUKVEhOb0U2dTlkVUJGVjZTeDNZSW9Zc3Fua3N0Z3A0bjBDOStneGZmL2d4enBZM2tDNVUyOFduc3BPK0NhK0dNcwpnL3ZrOGpEeUMzL0tRenU1MzRCdFZwbDF2TjdUcXdrcFlSRXl5NW01Kys3b2RvT3Y0TFBEaU9rZWtBeEM5VUw0CjRPVmJxRUFuOEFDQU9iZUFQcjd4WlpzM1NiU2hybzNHZ3Q2MnhneWU1QURGUzhqTnZQR2RjTStWTyt1TkNIOWgKczJzaWY4YlByVTBLT29NakpJcUFlUGRiQktqSEZwSndFVDNyeFpFNFNmMjBTSmtIM0NQQ0lEUDIKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcGdJQkFBS0NBUUVBdlhJZDYwUEZoZEt6cEcrSzVNQ2plUkR2a25xWi9uQ0VRNkh1ZE9nU2xYcmFxY3daCmptdG9jUlF6VE1aMDhRVjRFWGtPTjhqWllGOEU5MTJVMHlJN29Kd1NqVFNGK0M5SXh0VFhLL044QjhVZWJrcXIKbVY0VS96bkdwZjFIcEI3ZFNJRHdJN05aUzI4N3BqZjZ4MXZrTU1KVFhZRmQ1Y1NocitRNkZmUEhocUFUajZvbAowbUJRSFFIbnJQWGFMbWROVDdGRFhNcGVkdHhyVTBISkVqYnFKZXo2VVM0QW1aRGJNckxPUzNPelBTS2ZFL2hLCnB4WkFCa2piaERlZzBFejM3N0g5SW96VVNtU0dEVUpkckhUd3pCeVdNQ29rWExYUkFmMC92dWUycGgrZ0J1U20KT21JWHM1WnFveXZubHhXTXpnVWxnZnowWDkvaTloa3ZwQjlrRFFJREFRQUJBb0lCQVFDZlB6Z3JOYkxxUlMzQgpBZ3B0TkFtMmtTZnhwNkdmSXBIc0VFalVlT2gyUXVsZ1pqTHRaeGhLUmNMQnZPazhXVzZPc1lYa0dxK3Z0UEFGCngrSjhnSUJEQ0M4SUI2aTk4WEZwd2l5Rnc0ejFNeHZiZG1VODdMc1Z1RWxsNnJ5NEYwSEgycXNDTjViT05GaWQKNXR5bGpIY0xEYTdxSVA3L1VBVGlTQ1VUb3ZLTUZMMVJkOXZydm1aV1VnZkJ2dlU4S3pINlJVMklNZnlkQW5HRwpSOVViMEpYU2dyRGdrOGN4M1BLQ2FUN3U0MTh0Z01kRU5qZTJkUnlNazYwNkhXUldNU0lrL25CTTJCdTVOc1R5CkVqb2c0N3pzaVFZR2UvUEVNYTZsZGRmdGFTNkdhV0NmNGZEcnd1Um5nTVdhRVRDOUl0S1pDOU5wR2gyNmJsamQKQUtISXlLRTVBb0dCQU5pTXpFMmlmNUJqblRiVXUxRFFpb1MzQnZvMHZpZm5oTDAxL0NDcjdMNDJWT3VzNjNOeApQYTY1NVdFSTVZWm95ZUxLRXI4UUM2NStnTDlFVFYwbzV1R2dRdDNSQWlZdFdJRDRBMnVwM21PMGY4V293MENuCldZSlA4ekY5djA5ekZpMnRUR2NIbGxyWWNaZXptRGxxTWs1dWJBOVU2eElMQzlaV05kOU15bHFiQW9HQkFOLzEKUTUvbnRaMmFYbDdmcHJHNWlRa2xGSnZUN2xhOWNjMkJkcENueEQwNkMzMTB2TCtZMnNVTmN5K3RsM002QU5sVwpORVBLcDlwOUk1NXJ0dHVTMmpzeWRsc3p6S1U5cjAybnJ5UGltOFFRZE4zcUZaOWpjQVFORFUrMi9XUXVSUVFCCjFIZXR3VG0rMGVZWWp5am9xYzhHSnRXMW1XVDBUNTFoT3g1b1p6SjNBb0dCQU1DNUhpS0IybkhRbGR4MG0zaWoKQUlSNHQ3YjZOYm9oN0JyUTd1RE00ZGV2VndpZ1RyUGhObnBJYTRKZWZwZU9ydzR0dFYxaGxHUHBwZitUZEI3VApCaGdMbnpiMmlxa2Jka2JoYzNuZ0psSXFGQVQvMnpXeE9wSWxRVlRzaXRUVW9ncG96elJxcGorWG5oRGEvMEVwCjZEZXhRbTZxcnNMU0hlalZ0UUJVd1VxOUFvR0JBSUlJd2k4Q05tMC95RE9GNEIrby9td1UzNVpxd3lRUjh4WEQKYWJncjhNRXNCcWZkTkFwN0Vlc0FHRFZDc1lEeDJMUllYUmhQZm81WndtaWxXaEs3ZllLSmxqYjJLSWg0L0dRMgpUSGFsaUpPYWlvQ2UvZGNCd1hSWXI3WHRKY3NaSW5GbExwd2VndWFvYU84VXEycXhUSWNycHpqR3JEMzFySlJRCmRDYi9yNHVaQW9HQkFLVXZaVW0wRUg1YmRzY1FLREU0YmFOaEN3MkJZRUhNMWJUV3VQRE9ZSWdxOWZybHNmMzAKcmVqVTBScngwNDFLRURnZkpTVU9ZVVBSMEMreFFwYlBDQ2xaVzlhYjVhRlJjaVAwTUJURDgvOW12SkJoS3JBcQpIbHZEWDZyTWcvbEdxL0MyMTBtdW8vZzVmTWhJSllLK056bW5OSGx2Mk0xbXFYaVFVWklSRzcrOAotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: package-server
  namespace: olm
  labels:
    app: package-server
spec:
  strategy:
    type: RollingUpdate
  replicas: 1
  selector:
    matchLabels:
      app: package-server
  template:
    metadata:
      labels:
        app: package-server
    spec:
      serviceAccountName: olm-operator-serviceaccount
      containers:
      - name: package-server
        command:
        - /bin/package-server
        - -v=4
        - --global-namespace
        - olm
        - --debug
        image: quay.io/coreos/package-server@sha256:cc18b5711fb2126329c969f077f67f41981c87f800f6b2ceae5981422c14917b
        imagePullPolicy: Always
        ports:
        - containerPort: 443
        volumeMounts:
        - name: certs
          mountPath: /apiserver.local.config/certificates
          readOnly: true
        livenessProbe:
            httpGet:
              scheme: HTTPS
              path: /healthz
              port: 443
        readinessProbe:
            httpGet:
              scheme: HTTPS
              path: /healthz
              port: 443
      volumes:
      - name: certs
        secret:
          secretName: package-server-certs
          items:
          - key: tls.crt
            path: apiserver.crt
          - key: tls.key
            path: apiserver.key
      imagePullSecrets:
        - name: coreos-pull-secret
---
apiVersion: v1
kind: Service
metadata:
  name: package-server
  namespace: olm
spec:
  ports:
  - port: 443
    protocol: TCP
    targetPort: 443
  selector:
    app: package-server
